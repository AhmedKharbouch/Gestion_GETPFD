<div class="container mt-5">
  <div class="card shadow-lg p-3 mb-5 bg-white rounded">
    <div class="card-header bg-primary text-white">
      <h4>Fournisseurs</h4>
    </div>
    <div class="card-body">
      <div *ngIf="searchFormGroup" class="mt-4" style="width: 30%">
        <form class="d-flex mb-3" [formGroup]="searchFormGroup" (keyup)="handleSearchFournisseur()">
          <input class="form-control me-2" type="search" placeholder="Search by typing..." aria-label="Search" formControlName="keyword">
        </form>
      </div>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
          <tr>
            <th>ID</th>
            <th>Nom</th>
            <th>Phone</th>
            <th>Fixe</th>
            <th>Email</th>
            <th>created</th>
            <th>Modify</th>
            <th>Type</th>
            <th>Ville</th>
            <th>Actions</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let fournisseur of fournisseur | async">
            <td>{{ fournisseur.id }}</td>
            <td>{{ fournisseur.nom }}</td>
            <td>{{ fournisseur.telephone }}</td>
            <td>{{ fournisseur.telephoneFixe }}</td>
            <td>{{ fournisseur.email }}</td>
            <td>{{ fournisseur.createdAt | date: "MM-dd-yyyy" }}</td>
            <td>{{ fournisseur.modifiedAt ? (fournisseur.modifiedAt | date: "MM-dd-yyyy") : 'Pas de modif' }}</td>
            <td>{{ fournisseur.typeFournisseur?.nom || 'Pas de Type' }}</td>
            <td>{{ fournisseur.ville || 'Pas de ville' }}</td>
            <td>
              <button (click)="handleDeleteFournisseur(fournisseur)" class="btn btn-outline-danger me-1">
                <i class="bi bi-trash"></i>
              </button>
              <button (click)="handleUpdateFournisseur(fournisseur)" class="btn btn-outline-warning">
                <i class="bi bi-pencil-square"></i>
              </button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <ng-container *ngIf="errorMessage; else Loading">
    <div class="text-danger">{{ errorMessage }}</div>
  </ng-container>
  <ng-template #Loading></ng-template>
</div>
<div class="container mt-5">
  <div class="row">
    <div class="card shadow-lg p-3 mb-5 bg-white rounded">
      <div class="card-header bg-primary text-white">
        <h4>New Supplier</h4>
      </div>
      <div class="card-body">
        <form [formGroup]="formulaireNouveauFSR" (ngSubmit)="handleSaveFournisseur()" class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Name:</label>
            <input type="text" formControlName="nom" class="form-control" placeholder="Enter supplier name">
            <div *ngIf="formulaireNouveauFSR.get('nom')?.touched && formulaireNouveauFSR.get('nom')?.hasError('required')" class="text-danger">Name is required</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">Telephone:</label>
            <input type="text" formControlName="telephone" placeholder="Enter telephone" class="form-control">
            <div *ngIf="formulaireNouveauFSR.get('telephone')?.touched && formulaireNouveauFSR.get('telephone')?.hasError('required')" class="text-danger">Telephone is required</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">Fixed Telephone:</label>
            <input type="text" formControlName="telephoneFixe" placeholder="Enter fixed telephone" class="form-control">
            <div *ngIf="formulaireNouveauFSR.get('telephoneFixe')?.touched && formulaireNouveauFSR.get('telephoneFixe')?.hasError('required')" class="text-danger">Fixed Telephone is required</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">Email:</label>
            <input type="email" formControlName="email" placeholder="Enter email" class="form-control">
            <div *ngIf="formulaireNouveauFSR.get('email')?.touched && formulaireNouveauFSR.get('email')?.hasError('required')" class="text-danger">Email is required</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">Address:</label>
            <input type="text" formControlName="adresse" placeholder="Enter address" class="form-control">
            <div *ngIf="formulaireNouveauFSR.get('adresse')?.touched && formulaireNouveauFSR.get('adresse')?.hasError('required')" class="text-danger">Address is required</div>
          </div>
          <div class="col-md-6">
            <label class="form-label">City:</label>
            <input type="text" formControlName="ville" placeholder="Enter city" class="form-control">
            <div *ngIf="formulaireNouveauFSR.get('ville')?.touched && formulaireNouveauFSR.get('ville')?.hasError('required')" class="text-danger">City is required</div>
          </div>
          <div class="col-md-6">
            <label>Supplier Type:</label>
            <select formControlName="typeFsrId" class="form-select">
              <option value="" disabled selected>Choose a Type</option>
              <option *ngFor="let fsr of categories | async" [value]="fsr.id">{{ fsr.nom }}</option>
            </select>
          </div>
          <div class="col-md-12">
            <button class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

